---
title: Scorers
description: Combine multiple inputs into derived scores.
---

import { PropertyTable } from '@/components/PropertyTable';

# Scorers

Scorers combine multiple input metrics into a derived score.

## Import

```ts
import { defineInput, defineScorer } from 'tally';
import { createWeightedAverageScorer } from 'tally/scorers';
import type { CreateWeightedAverageScorerOptions } from 'tally/scorers';
```

### `defineInput()`

<PropertyTable
  content={[
    {
      name: 'metric',
      type: 'SingleTurnMetricDef | MultiTurnMetricDef',
      description: 'Metric definition used as input.',
    },
    {
      name: 'weight',
      type: 'number',
      description: 'Weight for this input when combining scores.',
    },
    {
      name: 'normalizerOverride',
      type: 'NormalizerSpec | NormalizeToScore',
      description: 'Optional normalizer override for this input.',
      isOptional: true,
    },
    {
      name: 'required',
      type: 'boolean',
      description: 'If false, missing score is ignored.',
      isOptional: true,
    },
  ]}
/>

### `defineScorer()`

<PropertyTable
  content={[
    { name: 'name', type: 'string', description: 'Scorer name (used in reports).' },
    {
      name: 'output',
      type: 'BaseMetricDef<number>',
      description: 'Base metric definition for the derived score.',
    },
    {
      name: 'inputs',
      type: 'readonly ScorerInput[]',
      description: 'Array of weighted inputs.',
    },
    {
      name: 'normalizeWeights',
      type: 'boolean',
      description: 'Normalize weights to sum to 1.',
      isOptional: true,
      defaultValue: 'true',
    },
    {
      name: 'combineScores',
      type: '(scores: InputScores) => Score',
      description: 'Optional custom combiner over scores.',
      isOptional: true,
    },
    {
      name: 'fallbackScore',
      type: 'Score',
      description: 'Optional fallback score when inputs are missing.',
      isOptional: true,
    },
    {
      name: 'description',
      type: 'string',
      description: 'Optional description for reports.',
      isOptional: true,
    },
    {
      name: 'metadata',
      type: 'Record<string, unknown>',
      description: 'Optional metadata for reports.',
      isOptional: true,
    },
  ]}
/>

### `createWeightedAverageScorer()`

<PropertyTable
  content={[
    { name: 'name', type: 'string', description: 'Scorer name (used in reports).' },
    {
      name: 'output',
      type: 'BaseMetricDef<number>',
      description: 'Base metric definition for the derived score.',
    },
    {
      name: 'inputs',
      type: 'readonly ScorerInput[]',
      description: 'Array of weighted inputs.',
    },
    {
      name: 'normalizeWeights',
      type: 'boolean',
      description: 'Normalize weights to sum to 1.',
      isOptional: true,
      defaultValue: 'true',
    },
    {
      name: 'fallbackScore',
      type: 'Score',
      description: 'Optional fallback score when inputs are missing.',
      isOptional: true,
    },
    {
      name: 'description',
      type: 'string',
      description: 'Optional description for reports.',
      isOptional: true,
    },
    {
      name: 'metadata',
      type: 'Record<string, unknown>',
      description: 'Optional metadata for reports.',
      isOptional: true,
    },
  ]}
/>

## Average scorer (equal weights)

Use `createWeightedAverageScorer` with the same weight for each input.

```ts
import { defineBaseMetric, defineInput } from 'tally';
import { createWeightedAverageScorer } from 'tally/scorers';

const averageOutput = defineBaseMetric<number>({
  name: 'averageQuality',
  valueType: 'number',
});

const averageScorer = createWeightedAverageScorer({
  name: 'AverageQuality',
  output: averageOutput,
  inputs: [
    defineInput({ metric: answerRelevance, weight: 1 }),
    defineInput({ metric: completeness, weight: 1 }),
    defineInput({ metric: roleAdherence, weight: 1 }),
  ],
});
```
